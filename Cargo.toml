[package]
name = "asset-io"
version = "0.1.0"
edition = "2021"
authors = ["Greg Peacock <gpeacock@adobe.com>"]
license = "MIT OR Apache-2.0"
description = "High-performance streaming I/O for media asset metadata (JUMBF, XMP, C2PA, thumbnails)"
repository = "https://github.com/contentauth/asset-io"
keywords = ["asset", "c2pa", "xmp", "jumbf", "metadata"]
categories = ["multimedia", "parsing"]

[dependencies]
# Core I/O
byteorder = "1.5"
thiserror = "1.0"
md5 = "0.7"

# Optional features
memmap2 = { version = "0.9", optional = true }
fs2 = { version = "0.4", optional = true }

# Hashing
sha2 = { version = "0.10", optional = true }

[dev-dependencies]
criterion = "0.5"
tempfile = "3.8"
sha2 = "0.10"  # For examples

[features]
default = ["jpeg", "test-utils"]
jpeg = []
png = []
exif = []  # EXIF parsing and embedded thumbnail extraction
memory-mapped = ["memmap2", "fs2"]
hashing = ["sha2"]
all-formats = ["jpeg", "png"]

# Note: At least one format feature (jpeg, png) must be enabled for the library to compile.

# Testing features
# embed-fixtures: Compile small test fixtures into the binary (faster CI, no file I/O)
# test-utils: Make test utilities available (enabled by default, disable with --no-default-features for production)
embed-fixtures = []
test-utils = []

# Example-specific features
[[example]]
name = "png_demo"
required-features = ["png"]

[[example]]
name = "thumbnail_demo"
# Thumbnail infrastructure is always available, no feature needed

[[example]]
name = "mmap_demo"
required-features = ["memory-mapped"]

[[example]]
name = "hash_demo"
required-features = ["hashing"]

[[example]]
name = "sha256_demo"
required-features = ["hashing"]

[profile.release]
opt-level = 3
lto = true
codegen-units = 1

[profile.bench]
inherits = "release"
